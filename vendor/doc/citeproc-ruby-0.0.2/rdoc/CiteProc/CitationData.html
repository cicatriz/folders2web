<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />

  <title>Class: CiteProc::CitationData</title>

  <link rel="stylesheet" href="../rdoc.css" type="text/css" media="screen" />

  <script src="../js/jquery.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/thickbox-compressed.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/quicksearch.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/darkfish.js" type="text/javascript" charset="utf-8"></script>

</head>
<body id="top" class="class">

  <div id="metadata">
    <div id="home-metadata">
      <div id="home-section" class="section">
        <h3 class="section-header">
          <a href="../index.html">Home</a>
          <a href="../index.html#classes">Classes</a>
          <a href="../index.html#methods">Methods</a>
        </h3>
      </div>
    </div>

    <div id="file-metadata">
      <div id="file-list-section" class="section">
        <h3 class="section-header">In Files</h3>
        <div class="section-body">
          <ul>
          
            <li><a href="../lib/citeproc/data_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
              class="thickbox" title="lib/citeproc/data.rb">lib/citeproc/data.rb</a></li>
          
          </ul>
        </div>
      </div>

      
    </div>

    <div id="class-metadata">
      
      <!-- Parent Class -->
      <div id="parent-class-section" class="section">
        <h3 class="section-header">Parent</h3>
        
        <p class="link">Object</p>
        
      </div>
      

      

      

      
      <!-- Method Quickref -->
      <div id="method-list-section" class="section">
        <h3 class="section-header">Methods</h3>
        <ul class="link-list">
          
          <li><a href="#method-c-new">::new</a></li>
          
          <li><a href="#method-c-parse">::parse</a></li>
          
          <li><a href="#method-i-citation_items">#citation_items</a></li>
          
          <li><a href="#method-i-merge-21">#merge!</a></li>
          
          <li><a href="#method-i-populate-21">#populate!</a></li>
          
          <li><a href="#method-i-properties">#properties</a></li>
          
        </ul>
      </div>
      

      
      <!-- Included Modules -->
      <div id="includes-section" class="section">
        <h3 class="section-header">Included Modules</h3>
        <ul class="link-list">
        
        
          <li><a class="include" href="../Support/Attributes.html">Support::Attributes</a></li>
        
        
        </ul>
      </div>
      
    </div>

    <div id="project-metadata">
      
      

      <div id="classindex-section" class="section project-section">
        <h3 class="section-header">Class/Module Index
          <span class="search-toggle"><img src="../images/find.png"
            height="16" width="16" alt="[+]"
            title="show/hide quicksearch" /></span></h3>
        <form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
        <fieldset>
          <legend>Quicksearch</legend>
          <input type="text" name="quicksearch" value=""
            class="quicksearch-field" />
        </fieldset>
        </form>

        <ul class="link-list">
        
          <li><a href="../CSL.html">CSL</a></li>
        
          <li><a href="../CSL/Bibliography.html">CSL::Bibliography</a></li>
        
          <li><a href="../CSL/Citation.html">CSL::Citation</a></li>
        
          <li><a href="../CSL/Key.html">CSL::Key</a></li>
        
          <li><a href="../CSL/Locale.html">CSL::Locale</a></li>
        
          <li><a href="../CSL/Node.html">CSL::Node</a></li>
        
          <li><a href="../CSL/Nodes.html">CSL::Nodes</a></li>
        
          <li><a href="../CSL/Nodes/Choose.html">CSL::Nodes::Choose</a></li>
        
          <li><a href="../CSL/Nodes/ConditionalBlock.html">CSL::Nodes::ConditionalBlock</a></li>
        
          <li><a href="../CSL/Nodes/Date.html">CSL::Nodes::Date</a></li>
        
          <li><a href="../CSL/Nodes/DatePart.html">CSL::Nodes::DatePart</a></li>
        
          <li><a href="../CSL/Nodes/EtAl.html">CSL::Nodes::EtAl</a></li>
        
          <li><a href="../CSL/Nodes/Group.html">CSL::Nodes::Group</a></li>
        
          <li><a href="../CSL/Nodes/Label.html">CSL::Nodes::Label</a></li>
        
          <li><a href="../CSL/Nodes/Layout.html">CSL::Nodes::Layout</a></li>
        
          <li><a href="../CSL/Nodes/Macro.html">CSL::Nodes::Macro</a></li>
        
          <li><a href="../CSL/Nodes/Name.html">CSL::Nodes::Name</a></li>
        
          <li><a href="../CSL/Nodes/NamePart.html">CSL::Nodes::NamePart</a></li>
        
          <li><a href="../CSL/Nodes/Names.html">CSL::Nodes::Names</a></li>
        
          <li><a href="../CSL/Nodes/Node.html">CSL::Nodes::Node</a></li>
        
          <li><a href="../CSL/Nodes/Number.html">CSL::Nodes::Number</a></li>
        
          <li><a href="../CSL/Nodes/Substitute.html">CSL::Nodes::Substitute</a></li>
        
          <li><a href="../CSL/Nodes/Text.html">CSL::Nodes::Text</a></li>
        
          <li><a href="../CSL/Renderer.html">CSL::Renderer</a></li>
        
          <li><a href="../CSL/Sort.html">CSL::Sort</a></li>
        
          <li><a href="../CSL/Style.html">CSL::Style</a></li>
        
          <li><a href="../CSL/Term.html">CSL::Term</a></li>
        
          <li><a href="../CiteProc.html">CiteProc</a></li>
        
          <li><a href="../CiteProc/Bibliography.html">CiteProc::Bibliography</a></li>
        
          <li><a href="../CiteProc/CitationData.html">CiteProc::CitationData</a></li>
        
          <li><a href="../CiteProc/Date.html">CiteProc::Date</a></li>
        
          <li><a href="../CiteProc/Format.html">CiteProc::Format</a></li>
        
          <li><a href="../CiteProc/Format/Default.html">CiteProc::Format::Default</a></li>
        
          <li><a href="../CiteProc/Format/Html.html">CiteProc::Format::Html</a></li>
        
          <li><a href="../CiteProc/Formatter.html">CiteProc::Formatter</a></li>
        
          <li><a href="../CiteProc/Item.html">CiteProc::Item</a></li>
        
          <li><a href="../CiteProc/Name.html">CiteProc::Name</a></li>
        
          <li><a href="../CiteProc/Processor.html">CiteProc::Processor</a></li>
        
          <li><a href="../CiteProc/Selector.html">CiteProc::Selector</a></li>
        
          <li><a href="../CiteProc/Variable.html">CiteProc::Variable</a></li>
        
          <li><a href="../Support.html">Support</a></li>
        
          <li><a href="../Support/Attributes.html">Support::Attributes</a></li>
        
          <li><a href="../Support/Attributes/ClassMethods.html">Support::Attributes::ClassMethods</a></li>
        
          <li><a href="../Support/Tree.html">Support::Tree</a></li>
        
          <li><a href="../Support/Tree/ClassMethods.html">Support::Tree::ClassMethods</a></li>
        
          <li><a href="../Extensions.html">Extensions</a></li>
        
          <li><a href="../Extensions/Core.html">Extensions::Core</a></li>
        
          <li><a href="../Extensions/Core/Numbers.html">Extensions::Core::Numbers</a></li>
        
          <li><a href="../Fixnum.html">Fixnum</a></li>
        
          <li><a href="../Kernel.html">Kernel</a></li>
        
        </ul>
        <div id="no-class-search-results" style="display: none;">No matching classes.</div>
      </div>

      
    </div>
  </div>

  <div id="documentation">
    <h1 class="class">CiteProc::CitationData</h1>

    <div id="description" class="description">
      
<h2>CiteProc::Data</h2>

<p>A minimal citation data object, used as input by both the
processCitationCluster() and appendCitationCluster() command, has the
following form:</p>

<p>{</p>

<pre>&quot;citationItems&quot;: [ { &quot;id&quot;: &quot;ITEM-1&quot; } ],
&quot;properties&quot;: {&quot;noteIndex&quot;: 1 }</pre>

<p>}</p>

<p>The citationItems array is a list of one or more citation item objects,
each containing an id used to retrieve the bibliographic details of the
target resource. A citation item object may contain one or more additional
optional values:</p>
<ul><li>
<p>locator: a string identifying a page number or other pinpoint location or
range within the resource;</p>
</li><li>
<p>label: a label type, indicating whether the locator is to a page, a
chapter, or other subdivision of the target resource. Valid labels are
defined in the link <a href="../CSL.html">CSL</a> specification.</p>
</li><li>
<p>suppress-author: if true, author names will not be included in the citation
output for this cite;</p>
</li><li>
<p>author-only: if true, only the author name will be included in the citation
output for this cite – this optional parameter provides a means for certain
demanding styles that require the processor output to be divided between
the main text and a footnote.</p>
</li><li>
<p>prefix: a string to print before this cite item;</p>
</li><li>
<p>suffix: a string to print after this cite item.</p>
</li></ul>

<p>In the properties portion of a citation, the noteIndex value indicates the
footnote number in which the citation is located within the document.
Citations within the main text of the document have a noteIndex of zero.</p>

<p>The processor will add a number of data items to a citation during
processing. Values added at the top level of the citation structure
include:</p>
<ul><li>
<p>citationID: A unique ID assigned to the citation, for internal use by the
processor. This ID may be assigned by the calling application, but it must
uniquely identify the citation, and it must not be changed during
processing or during an editing session.</p>
</li><li>
<p>sortedItems: This is an array of citation objects and accompanying
bibliographic data objects, sorted as required by the configured style.
Calling applications should not need to access the data in this array
directly.</p>
</li></ul>

<p>Values added to individual citation item objects may include:</p>
<ul><li>
<p>sortkeys: an array of sort keys used by the processor to produce the sorted
list in sortedItems. Calling applications should not need to touch this
array directly.</p>
</li><li>
<p>position: an integer flag that indicates whether the cite item should be
rendered as a first reference, an immediately-following reference (i.e.
ibid), an immediately-following reference with locator information, or a
subsequent reference.</p>
</li><li>
<p>first-reference-note-number: the number of the noteIndex of the first
reference to this resource in the document.</p>
</li><li>
<p>near-note: a boolean flag indicating whether another reference to this
resource can be found within a specific number of notes, counting back from
the current position. What is “near” in this sense is style-dependent.</p>
</li><li>
<p>unsorted: a boolean flag indicating whether sorting imposed by the style
should be suspended for this citation. When true, cites are rendered in the
order in which they are presented in citationItems.</p>
</li></ul>

    </div><!-- description -->

    
    
    
    <div id="5Buntitled-5D" class="documentation-section">
      

      

      

      

      <!-- Methods -->
      
      <div id="public-class-method-details" class="method-section section">
        <h3 class="section-header">Public Class Methods</h3>

      
        <div id="new-method" class="method-detail ">
          <a name="method-c-new"></a>

          
          <div class="method-heading">
            <span class="method-name">new</span><span
              class="method-args">(attributes={})</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="new-source">
<pre>
<span class="ruby-comment"># File lib/citeproc/data.rb, line 77</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">attributes</span>={})

  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">key_filter</span> = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">hash</span>, <span class="ruby-identifier">key</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">key</span>] = <span class="ruby-identifier">key</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">/([[:lower:]])([[:upper:]])/</span>, <span class="ruby-string">'\1-\2'</span>).<span class="ruby-identifier">downcase</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">attributes</span>)
  
  <span class="ruby-keyword">yield</span> <span class="ruby-keyword">self</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- new-source -->
            
          </div>

          

          
        </div><!-- new-method -->

      
        <div id="parse-method" class="method-detail ">
          <a name="method-c-parse"></a>

          
          <div class="method-heading">
            <span class="method-name">parse</span><span
              class="method-args">(argument)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>@returns a list of citation data</p>
            

            
            <div class="method-source-code" id="parse-source">
<pre>
<span class="ruby-comment"># File lib/citeproc/data.rb, line 89</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">argument</span>)
  <span class="ruby-keyword">return</span> [] <span class="ruby-keyword">if</span> <span class="ruby-identifier">argument</span>.<span class="ruby-identifier">nil?</span>
  <span class="ruby-identifier">argument</span> = [<span class="ruby-identifier">argument</span>] <span class="ruby-keyword">unless</span> <span class="ruby-identifier">argument</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">Array</span>)
  <span class="ruby-identifier">argument</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">d</span><span class="ruby-operator">|</span> <span class="ruby-constant">CitationData</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">d</span>) }
<span class="ruby-keyword">end</span></pre>
            </div><!-- parse-source -->
            
          </div>

          

          
        </div><!-- parse-method -->

      
      </div><!-- public-class-method-details -->
    
      <div id="public-instance-method-details" class="method-section section">
        <h3 class="section-header">Public Instance Methods</h3>

      
        <div id="citation_items-method" class="method-detail ">
          <a name="method-i-citation_items"></a>

          
          <div class="method-heading">
            <span class="method-name">citation_items</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="citation_items-source">
<pre>
<span class="ruby-comment"># File lib/citeproc/data.rb, line 122</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">citation_items</span>
  <span class="ruby-identifier">attributes</span>[<span class="ruby-string">'citation-items'</span>] <span class="ruby-operator">||=</span> []
<span class="ruby-keyword">end</span></pre>
            </div><!-- citation_items-source -->
            
          </div>

          

          
        </div><!-- citation_items-method -->

      
        <div id="merge-21-method" class="method-detail ">
          <a name="method-i-merge-21"></a>

          
          <div class="method-heading">
            <span class="method-name">merge!</span><span
              class="method-args">(argument)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Merges the argument into the citation data. The argument can be a list of
citation items (hashes), a single citation item (hash), another citation
data instance or hash, or a single id of a citation item.</p>
            

            
            <div class="method-source-code" id="merge-21-source">
<pre>
<span class="ruby-comment"># File lib/citeproc/data.rb, line 100</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">argument</span>)
  <span class="ruby-keyword">case</span>
  <span class="ruby-keyword">when</span> <span class="ruby-identifier">argument</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">argument</span>.<span class="ruby-identifier">map</span>(&amp;<span class="ruby-value">:class</span>).<span class="ruby-identifier">uniq</span> <span class="ruby-operator">==</span> [<span class="ruby-constant">Hash</span>]
    <span class="ruby-keyword">super</span>(<span class="ruby-string">'citation-items'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">argument</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">argument</span><span class="ruby-operator">|</span> <span class="ruby-constant">Item</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">argument</span>) })
    
  <span class="ruby-keyword">when</span> <span class="ruby-identifier">argument</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>) <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">argument</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">argument</span>.<span class="ruby-identifier">map</span>(&amp;<span class="ruby-value">:class</span>).<span class="ruby-identifier">uniq</span> <span class="ruby-operator">==</span> [<span class="ruby-constant">Item</span>])
    <span class="ruby-keyword">super</span>(<span class="ruby-string">'citation-items'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">argument</span>)

  <span class="ruby-keyword">when</span> <span class="ruby-identifier">argument</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)
    <span class="ruby-identifier">argument</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-string">'id'</span>) <span class="ruby-operator">?</span> <span class="ruby-keyword">super</span>(<span class="ruby-string">'citation-items'</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-constant">Item</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">argument</span>)]) <span class="ruby-operator">:</span> <span class="ruby-keyword">super</span>(<span class="ruby-identifier">argument</span>)
    
  <span class="ruby-keyword">when</span> <span class="ruby-identifier">argument</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">String</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">argument</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Symbol</span>)
    <span class="ruby-keyword">super</span>(<span class="ruby-string">'citation-items'</span> =<span class="ruby-operator">&gt;</span> [{ <span class="ruby-string">'id'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">argument</span>.<span class="ruby-identifier">to_s</span> }])

  <span class="ruby-keyword">when</span> <span class="ruby-identifier">argument</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">CitationData</span>)
    <span class="ruby-keyword">super</span>(<span class="ruby-identifier">argument</span>.<span class="ruby-identifier">attributes</span>)

  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">raise</span>(<span class="ruby-constant">ArgumentError</span>, <span class="ruby-node">&quot;unable to merge #{argument.inspect} into citation data&quot;</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- merge-21-source -->
            
          </div>

          

          
        </div><!-- merge-21-method -->

      
        <div id="populate-21-method" class="method-detail ">
          <a name="method-i-populate-21"></a>

          
          <div class="method-heading">
            <span class="method-name">populate!</span><span
              class="method-args">(items)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="populate-21-source">
<pre>
<span class="ruby-comment"># File lib/citeproc/data.rb, line 126</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">populate!</span>(<span class="ruby-identifier">items</span>)
  <span class="ruby-identifier">citation_items</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">item</span><span class="ruby-operator">|</span> <span class="ruby-identifier">item</span>.<span class="ruby-identifier">reverse_merge!</span>(<span class="ruby-identifier">items</span>[<span class="ruby-identifier">item</span>.<span class="ruby-identifier">id</span>.<span class="ruby-identifier">to_s</span>]) }
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- populate-21-source -->
            
          </div>

          

          
        </div><!-- populate-21-method -->

      
        <div id="properties-method" class="method-detail ">
          <a name="method-i-properties"></a>

          
          <div class="method-heading">
            <span class="method-name">properties</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="properties-source">
<pre>
<span class="ruby-comment"># File lib/citeproc/data.rb, line 131</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">properties</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">attributes</span>[<span class="ruby-string">'properties'</span>] <span class="ruby-operator">||=</span> {}
<span class="ruby-keyword">end</span></pre>
            </div><!-- properties-source -->
            
          </div>

          

          
        </div><!-- properties-method -->

      
      </div><!-- public-instance-method-details -->
    
    </div><!-- 5Buntitled-5D -->
  

  </div><!-- documentation -->

  <div id="validator-badges">
    <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
    <p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
      Rdoc Generator</a> 2</small>.</p>
  </div>

</body>
</html>

